name: Generate Metrics (multi)

on:
  schedule:
    - cron: "0 */12 * * *"
  workflow_dispatch:

permissions:
  contents: write

jobs:
  metrics:
    runs-on: ubuntu-latest
    steps:
      # 1) habits.charts
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: Rrrapce
          base: ""                         # čisto, bez header/community
          template: classic
          filename: metrics.plugin.habits.charts.svg
          committer_token: ${{ github.token }}
          config_timezone: Europe/Sarajevo
          plugin_habits: yes
          plugin_habits_charts: yes
          plugin_habits_days: 30
          plugin_habits_from: 200
          plugin_habits_trim: yes

      # 2) introduction
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: Rrrapce
          base: ""
          template: classic
          filename: metrics.plugin.introduction.svg
          committer_token: ${{ github.token }}
          plugin_introduction: yes
          plugin_introduction_title: yes

      # 3) languages (indepth)
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: Rrrapce
          base: ""
          template: classic
          filename: metrics.plugin.languages.indepth.svg
          committer_token: ${{ github.token }}
          plugin_languages: yes
          plugin_languages_indepth: true
          plugin_languages_sections: most-used, recently-used
          plugin_languages_limit: 12
          plugin_languages_recent_days: 30
          plugin_languages_details: percentage
          plugin_languages_threshold: 1%
          plugin_languages_other: true
          plugin_languages_aliases: "C++:CPP, C#:CSharp"

      # 4) wakatime
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: Rrrapce
          base: ""
          template: classic
          filename: metrics.plugin.wakatime.svg
          committer_token: ${{ github.token }}
          config_timezone: Europe/Sarajevo
          plugin_wakatime: yes
          plugin_wakatime_token: ${{ secrets.WAKATIME_API_KEY }}
          plugin_wakatime_days: 7
          plugin_wakatime_sections: time, projects, languages, editors
          plugin_wakatime_limit: 5

      # 5) repository (featured/pinned)
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: Rrrapce
          base: ""
          template: classic
          filename: metrics.repository.svg
          committer_token: ${{ github.token }}
          plugin_repositories: yes
          plugin_repositories_pinned: 6      # koliko prikazati (promijeni po želji)
          plugin_repositories_starred: no
          plugin_repositories_order: featured

      # 6) classic komplet (po želji)
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: Rrrapce
          template: classic
          base: header, activity, repositories  # minimalistički classic
          filename: metrics.classic.svg
          committer_token: ${{ github.token }}


      # 7) contributions calendar (isocalendar)
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: Rrrapce
          base: ""                       # čist output, samo kalendar
          template: classic
          filename: metrics.contributions.calendar.svg
          committer_token: ${{ github.token }}
          config_timezone: Europe/Sarajevo

          plugin_isocalendar: yes
          plugin_isocalendar_duration: full-year   # opcije: half-year | full-year

